# ------------------------------------------------------
# THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
# ------------------------------------------------------

type Organization {
  _id: ID!
  name: String!
  owner: String!
  bucket: String!
}

type UserPermissions {
  _id: ID!
  user: String!
  org: Organization!
  read: Boolean!
  write: Boolean!
  delete: Boolean!
  admin: Boolean!
}

"""Signed Request for a user to access a resource"""
type SignedRequest {
  """
  If the user has been granted access, the other fields are only populated if this is true
  """
  authorized: Boolean!

  """The AWS signature"""
  signature: String

  """SHA256 hash of the body"""
  hash: String
}

type Query {
  authenticate: Boolean!
  authorize(resource: ResourceRequest!): SignedRequest!
  getUserPermissions: [UserPermissions!]!
  getUserPermissionsPerOrganization(organization: ID!): [UserPermissions!]!
  getOriganizations: [Organization!]!
}

"""Bucket resource a user is attempting to access"""
input ResourceRequest {
  account: String!
  bucket: String
  object: String
  method: RequestMethod!

  """Raw HTTP request which is used to produce the AWS Signature"""
  request: JSON!
}

enum RequestMethod {
  GET
  POST
  PUT
  DELETE
  PATCH
  ALL
  OPTIONS
  HEAD
}

"""
The `JSON` scalar type represents JSON values as specified by [ECMA-404](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf).
"""
scalar JSON

type Mutation {
  updatePermissions(
    """ID of the UserPermission to be changed"""
    permission: ID!
    change: PermissionChange!
  ): UserPermissions!
}

input PermissionChange {
  read: Boolean
  write: Boolean
  delete: Boolean
  admin: Boolean
}